# üß™ SQL Injection –¢–µ—Å—Ç-–∫–µ–π—Å—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞—â–∏—Ç—ã

## ‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù–´!

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞—â–∏—Ç—ã –æ—Ç SQL Injection –≤ –≤–∞—à–µ–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ SQL.

---

## 1. –ë–∞–∑–æ–≤—ã–µ SQL Injection –∞—Ç–∞–∫–∏

### –¢–µ—Å—Ç 1.1: DROP TABLE
```sql
SELECT * FROM users; DROP TABLE users; --
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–æ–¥–µ—Ä–∂–∏—Ç DROP)

### –¢–µ—Å—Ç 1.2: DELETE
```sql
SELECT * FROM users; DELETE FROM users WHERE id = 1; --
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–æ–¥–µ—Ä–∂–∏—Ç DELETE)

### –¢–µ—Å—Ç 1.3: UPDATE
```sql
SELECT * FROM users; UPDATE users SET password = 'hacked' WHERE id = 1; --
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–æ–¥–µ—Ä–∂–∏—Ç UPDATE)

### –¢–µ—Å—Ç 1.4: INSERT
```sql
SELECT * FROM users; INSERT INTO users (name) VALUES ('hacker'); --
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–æ–¥–µ—Ä–∂–∏—Ç INSERT)

---

## 2. SQL Injection —á–µ—Ä–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

### –¢–µ—Å—Ç 2.1: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –æ–ø–∞—Å–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π
```sql
SELECT * FROM users -- DROP TABLE users
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω)

### –¢–µ—Å—Ç 2.2: –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
```sql
SELECT * FROM users /* DROP TABLE users */
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω)

### –¢–µ—Å—Ç 2.3: –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å UPDATE
```sql
SELECT * FROM users -- UPDATE users SET password = 'hacked'
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω)

---

## 3. UNION SELECT Injection

### –¢–µ—Å—Ç 3.1: UNION SELECT –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –¥—Ä—É–≥–∏–º —Ç–∞–±–ª–∏—Ü–∞–º
```sql
SELECT * FROM users UNION SELECT * FROM passwords
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω (–µ—Å–ª–∏ UNION —è–≤–Ω–æ —Ä–∞–∑—Ä–µ—à–µ–Ω), –Ω–æ –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è

### –¢–µ—Å—Ç 3.2: UNION SELECT —Å —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏
```sql
SELECT * FROM users UNION SELECT * FROM pg_user
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ pg_user)

---

## 4. –î–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º

### –¢–µ—Å—Ç 4.1: PostgreSQL —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
```sql
SELECT * FROM pg_user
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ pg_)

### –¢–µ—Å—Ç 4.2: information_schema
```sql
SELECT * FROM information_schema.tables
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ information_schema)

### –¢–µ—Å—Ç 4.3: pg_catalog
```sql
SELECT * FROM pg_catalog.pg_database
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ pg_)

### –¢–µ—Å—Ç 4.4: MySQL —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
```sql
SELECT * FROM mysql.user
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ mysql.)

### –¢–µ—Å—Ç 4.5: sys —Å—Ö–µ–º—ã
```sql
SELECT * FROM sys.tables
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ sys.)

---

## 5. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### –¢–µ—Å—Ç 5.1: –î–≤–∞ –∑–∞–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É —Å –∑–∞–ø—è—Ç–æ–π
```sql
SELECT * FROM users; SELECT * FROM passwords;
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ö†Ô∏è –î–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å (–∑–∞—â–∏—Ç–∞ –æ—Ç –º—É–ª—å—Ç–∏-–∑–∞–ø—Ä–æ—Å–æ–≤)

### –¢–µ—Å—Ç 5.2: SELECT + DROP —á–µ—Ä–µ–∑ —Ç–æ—á–∫—É —Å –∑–∞–ø—è—Ç–æ–π
```sql
SELECT * FROM users; DROP TABLE users;
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–æ–¥–µ—Ä–∂–∏—Ç DROP)

---

## 6. –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

### –¢–µ—Å—Ç 6.1: EXEC / EXECUTE
```sql
SELECT * FROM users; EXEC xp_cmdshell('dir')
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–æ–¥–µ—Ä–∂–∏—Ç EXEC)

### –¢–µ—Å—Ç 6.2: CALL
```sql
SELECT * FROM users; CALL dangerous_procedure()
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–æ–¥–µ—Ä–∂–∏—Ç CALL)

### –¢–µ—Å—Ç 6.3: GRANT
```sql
SELECT * FROM users; GRANT ALL ON *.* TO 'hacker'@'%'
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–æ–¥–µ—Ä–∂–∏—Ç GRANT)

---

## 7. –û–±—Ö–æ–¥ —á–µ—Ä–µ–∑ –ø–æ–¥–∑–∞–ø—Ä–æ—Å—ã (—Å–ª–æ–∂–Ω—ã–µ —Å–ª—É—á–∞–∏)

### –¢–µ—Å—Ç 7.1: –ü–æ–¥–∑–∞–ø—Ä–æ—Å —Å —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π
```sql
SELECT * FROM users WHERE id IN (SELECT id FROM pg_user)
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ pg_user)

### –¢–µ—Å—Ç 7.2: JOIN —Å —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π
```sql
SELECT * FROM users JOIN information_schema.tables ON 1=1
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (—Å–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ information_schema)

---

## 8. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –∑–∞–ø—Ä–æ—Å–∞ (DoS –∑–∞—â–∏—Ç–∞)

### –¢–µ—Å—Ç 8.1: –û—á–µ–Ω—å –¥–ª–∏–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å (>100KB)
```sql
SELECT * FROM users WHERE id = 1 AND 'a' = 'a' AND 'a' = 'a' ... (–ø–æ–≤—Ç–æ—Ä–∏—Ç—å –º–Ω–æ–≥–æ —Ä–∞–∑)
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (–ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç 100KB)

---

## 9. –í–∞–ª–∏–¥–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å)

### –¢–µ—Å—Ç 9.1: –û–±—ã—á–Ω—ã–π SELECT
```sql
SELECT * FROM users WHERE id = 1
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω

### –¢–µ—Å—Ç 9.2: SELECT —Å JOIN
```sql
SELECT u.name, o.total FROM users u JOIN orders o ON u.id = o.user_id
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω

### –¢–µ—Å—Ç 9.3: SELECT —Å –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–º
```sql
SELECT * FROM users WHERE id IN (SELECT user_id FROM orders)
```
**–û–∂–∏–¥–∞–Ω–∏–µ:** ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω (–µ—Å–ª–∏ orders - –Ω–µ —Å–∏—Å—Ç–µ–º–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞)

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

- [ ] –í—Å–µ DROP/DELETE/UPDATE/INSERT –∑–∞–ø—Ä–æ—Å—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- [ ] –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å –æ–ø–∞—Å–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- [ ] –î–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º —Ç–∞–±–ª–∏—Ü–∞–º (pg_, information_schema, mysql., sys.) –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
- [ ] –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –±–µ–∑–æ–ø–∞—Å–Ω–æ (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π)
- [ ] EXEC/EXECUTE/CALL –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- [ ] –ó–∞–ø—Ä–æ—Å—ã >100KB –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- [ ] –í–∞–ª–∏–¥–Ω—ã–µ SELECT –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç

---

## üéØ –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä SQL
2. –í—Å—Ç–∞–≤—å—Ç–µ –æ–¥–∏–Ω –∏–∑ —Ç–µ—Å—Ç-–∫–µ–π—Å–æ–≤ –≤—ã—à–µ
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –æ–ø–∞—Å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ–± –æ—à–∏–±–∫–µ
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–∞–ª–∏–¥–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç

---

## ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

- `‚ùå Dangerous operations are not allowed` - –¥–ª—è DROP/DELETE/UPDATE –∏ —Ç.–¥.
- `‚ùå Access to system tables is not allowed` - –¥–ª—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
- `‚ùå Suspicious SQL pattern detected` - –¥–ª—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- `‚ùå SQL query is too long (max 100KB)` - –¥–ª—è —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

