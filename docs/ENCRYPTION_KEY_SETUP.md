# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ ENCRYPTION_KEY

## –ß—Ç–æ —ç—Ç–æ?

`ENCRYPTION_KEY` ‚Äî —ç—Ç–æ —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è connection strings –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. –ë–µ–∑ —ç—Ç–æ–≥–æ –∫–ª—é—á–∞ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö connection strings –±—É–¥–µ—Ç –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞.

## üîç –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª—é—á?

**–ö–ª—é—á –Ω—É–∂–µ–Ω –≤ Vercel (Next.js), –∞ –ù–ï –≤ Supabase!**

- ‚úÖ **Vercel:** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ Next.js API routes (`pages/api/save-connection.ts`)
- ‚ùå **Supabase:** –¢–æ–ª—å–∫–æ —Ö—Ä–∞–Ω–∏—Ç —É–∂–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)

–ü–æ–¥—Ä–æ–±–Ω–µ–µ —Å–º. `docs/ENCRYPTION_ARCHITECTURE.md`

## ‚ö†Ô∏è –í–ê–ñ–ù–û

- **–ö–∞–∂–¥—ã–π –ø—Ä–æ–µ–∫—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Å–≤–æ–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á**
- **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –∫–ª—é—á–µ–π –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**
- **–•—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á –≤ —Å–µ–∫—Ä–µ—Ç–∞—Ö –∏ –ù–ï –∫–æ–º–º–∏—Ç—å—Ç–µ –≤ Git**

---

## üîë –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: Node.js (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

–í—ã–≤–æ–¥ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:
```
9162eef67b00570384a6ee5ed4b05495bfc0335953a5bcb2843431d85a33fd86
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: OpenSSL

```bash
openssl rand -hex 32
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: PowerShell (Windows)

```powershell
-join ((48..57) + (97..102) | Get-Random -Count 64 | % {[char]$_})
```

---

## üìù –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–ª—é—á–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (`.env.local`)

1. –°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `.env.local` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞
2. –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É:
   ```bash
   ENCRYPTION_KEY=–≤–∞—à-—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π-–∫–ª—é—á-64-—Å–∏–º–≤–æ–ª–∞
   ```
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `.env.local` –≤ `.gitignore` (–Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –µ–≥–æ!)
4. ‚ö†Ô∏è **–í–ê–ñ–ù–û:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—Ç –∂–µ –∫–ª—é—á, —á—Ç–æ –∏ –≤ Vercel (–¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç—ã —Å –æ–¥–Ω–∏–º–∏ –∏ —Ç–µ–º–∏ –∂–µ –¥–∞–Ω–Ω—ã–º–∏)

### Production (Vercel)

1. –û—Ç–∫—Ä–æ–π—Ç–µ Vercel Dashboard
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Settings ‚Üí Environment Variables
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é:
   - **Name:** `ENCRYPTION_KEY`
   - **Value:** –≤–∞—à —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á
   - **Environment:** Production, Preview, Development (–∏–ª–∏ —Ç–æ–ª—å–∫–æ Production)
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–ø–ª–æ–π
5. ‚ö†Ô∏è **–í–ê–ñ–ù–û:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—Ç –∂–µ –∫–ª—é—á, —á—Ç–æ –∏ –≤ `.env.local` (–¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –æ–¥–Ω–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏)

---

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ connection strings –ë–ï–ó —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:

1. **–í–∞—Ä–∏–∞–Ω—Ç 1 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Å–æ—Ö—Ä–∞–Ω—è—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–æ–Ω–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—à–∏—Ñ—Ä—É—é—Ç—Å—è)
2. **–í–∞—Ä–∏–∞–Ω—Ç 2:** –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –•—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –ù–ï –∫–æ–º–º–∏—Ç—å—Ç–µ –∫–ª—é—á –≤ Git
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è dev/staging/production
- ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ—Ç–∏—Ä—É–π—Ç–µ –∫–ª—é—á–∏ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
- ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- ‚ùå –ù–ï –ø—É–±–ª–∏–∫—É–π—Ç–µ –∫–ª—é—á –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–ª–∏ –ø—Ä–∏–º–µ—Ä–∞—Ö

---

## ‚ö†Ô∏è –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –∫–ª—é—á–∞?

- **Development:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–ª—é—á (–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ!)
- **Production:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–∏—Ç –æ—à–∏–±–∫—É –∏ –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è

```typescript
// –ò–∑ lib/encryption.ts
if (process.env.NODE_ENV === 'production') {
  throw new Error('ENCRYPTION_KEY must be set in production environment');
}
```

---

## üìã –ß–µ–∫–ª–∏—Å—Ç

- [ ] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á
- [ ] –ö–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env.local` (–ª–æ–∫–∞–ª—å–Ω–æ) ‚Üê **–ù–ï —É–¥–∞–ª—è—Ç—å!**
- [ ] –ö–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ Vercel Environment Variables (production)
- [ ] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á** –≤ –æ–±–µ–∏—Ö —Å—Ä–µ–¥–∞—Ö
- [ ] `.env.local` –≤ `.gitignore`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏

---

## ‚ùì FAQ

### –ù—É–∂–Ω–æ –ª–∏ —É–¥–∞–ª—è—Ç—å –∫–ª—é—á –∏–∑ `.env.local`, –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å –≤ Vercel?

**–ù–ï–¢!** –ö–ª—é—á –Ω—É–∂–µ–Ω –≤ **–æ–±–æ–∏—Ö –º–µ—Å—Ç–∞—Ö**:
- `.env.local` ‚Üí –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (`npm run dev`)
- Vercel ‚Üí –¥–ª—è production/staging –¥–µ–ø–ª–æ–µ–≤

–û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è—Ö –∏ –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç –º–µ–∂–¥—É —Å–æ–±–æ–π.

